<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload File - NetStore</title>
    <style>
        /* --- Existing CSS kept intact --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #6dd5ed 0%, #2193b0 100%); min-height: 100vh; padding: 20px; }
        .navbar { background: rgba(255, 255, 255, 0.95); padding: 25px 50px; border-radius: 20px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); }
        .navbar-brand { font-size: 2em; font-weight: 700; color: #0c758c; text-decoration: none; }
        .navbar-links { display: flex; gap: 20px; }
        .navbar-links a { color: #4a5568; text-decoration: none; font-weight: 500; transition: color 0.3s; font-size: 1.2em; padding: 8px 15px; }
        .navbar-links a:hover { color: #6dd5ed; }
        .container { max-width: 700px; margin: 0 auto; background: rgba(255, 255, 255, 0.95); border-radius: 20px; padding: 50px 40px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); }
        h1 { color: #2d3748; font-size: 2.2em; margin-bottom: 10px; text-align: center; }
        .description { text-align: center; color: #718096; margin-bottom: 40px; font-size: 1.05em; }
        .upload-area { border: 3px dashed #cbd5e0; border-radius: 15px; padding: 60px 30px; text-align: center; margin-bottom: 30px; transition: all 0.3s ease; cursor: pointer; background: #f7fafc; }
        .upload-area:hover { border-color: #6dd5ed; background: #edf2f7; }
        .upload-area.drag-over { border-color: #6dd5ed; background: #e6f0ff; }
        .upload-icon { font-size: 4em; margin-bottom: 20px; }
        .upload-text { color: #4a5568; font-size: 1.2em; margin-bottom: 10px; }
        .upload-subtext { color: #a0aec0; font-size: 0.95em; }
        input[type="file"] { display: none; }
        .file-info { background: #f7fafc; padding: 20px; border-radius: 12px; margin-bottom: 25px; display: none; }
        .file-info.show { display: block; }
        .file-name { color: #2d3748; font-weight: 600; font-size: 1.1em; margin-bottom: 5px; }
        .file-size { color: #718096; font-size: 0.9em; }
        .upload-btn { background: linear-gradient(135deg, #6dd5ed 0%, #2193b0 100%); color: white; padding: 18px 40px; border: none; border-radius: 12px; font-size: 1.1em; font-weight: 600; cursor: pointer; width: 100%; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); }
        .upload-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(109, 213, 237, 0.5); }
        .upload-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .success-message { background: #c6f6d5; color: #22543d; padding: 20px; border-radius: 12px; margin-top: 25px; display: none; text-align: center; font-weight: 600; border: 2px solid #9ae6b4; }
        .success-message.show { display: block; animation: slideIn 0.5s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .loading { display: none; justify-content: center; align-items: center; margin-top: 20px; }
        .loading.show { display: flex; }
        .spinner { border: 4px solid #e2e8f0; border-top: 4px solid #6dd5ed; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @media (max-width: 768px) { .navbar { flex-direction: column; gap: 15px; } .container { padding: 35px 25px; } }
    </style>
</head>

<body>
    <nav class="navbar">
        <a href="/" class="navbar-brand">üì¶ NetStore</a>
        <div class="navbar-links">
            <a href="/upload">Upload</a>
            <a href="/files">View Files</a>
        </div>
    </nav>

    <div class="container">
        <h1>Upload File</h1>
        <p class="description">Select a file to upload to the distributed storage system</p>

        <form id="uploadForm" enctype="multipart/form-data">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">üìÅ</div>
                <div class="upload-text">Click to select a file</div>
                <div class="upload-subtext">or drag and drop it here</div>
                <input type="file" id="fileInput" name="file" required>
            </div>

            <div class="file-info" id="fileInfo">
                <div class="file-name" id="fileName"></div>
                <div class="file-size" id="fileSize"></div>
            </div>

            <button type="submit" class="upload-btn" id="uploadBtn">
                Upload to NetStore
            </button>

            <div class="loading" id="loading">
                <div class="spinner"></div>
            </div>

            <div class="success-message" id="successMessage">
                ‚úÖ File uploaded and replicated successfully!
            </div>
        </form>
    </div>

    <script>
        // --- JS kept intact for drag/drop and upload ---
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const uploadForm = document.getElementById('uploadForm');
        const uploadBtn = document.getElementById('uploadBtn');
        const loading = document.getElementById('loading');
        const successMessage = document.getElementById('successMessage');

        uploadArea.addEventListener('click', () => fileInput.click());
        uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('drag-over'); });
        uploadArea.addEventListener('dragleave', () => uploadArea.classList.remove('drag-over'));
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            if (files.length > 0) { fileInput.files = files; displayFileInfo(files[0]); }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) displayFileInfo(e.target.files[0]);
        });

        function displayFileInfo(file) {
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            fileInfo.classList.add('show');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        uploadForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(uploadForm);
            uploadBtn.disabled = true;
            loading.classList.add('show');
            successMessage.classList.remove('show');

            try {
                const response = await fetch('/upload', { method: 'POST', body: formData });
                if (response.ok) {
                    loading.classList.remove('show');
                    successMessage.classList.add('show');
                    uploadForm.reset();
                    fileInfo.classList.remove('show');
                    uploadBtn.disabled = false;
                    setTimeout(() => successMessage.classList.remove('show'), 5000);
                } else throw new Error('Upload failed');
            } catch (error) {
                alert('Upload failed. Please try again.');
                loading.classList.remove('show');
                uploadBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
